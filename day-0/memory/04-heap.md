# Куча (Heap) — большая память

[← Стек](03-stack.md) | [Оглавление](README.md) | [Владение →](05-ownership.md)

---

## Что такое куча?

**Куча** (англ. **heap**) — большой склад, где берёшь место по необходимости.

> Выделение памяти в куче называется **динамическое выделение** (англ. **dynamic allocation** или **heap allocation**).

```
Куча:
┌─────┬────────────┬──────┬─────────┐
│#####│  Привет!   │      │ [1,2,3] │
└─────┴────────────┴──────┴─────────┘
   ↑        ↑         ↑        ↑
занято   строка   свободно  список
```

Данные разбросаны — нужно помнить где что.

---

## Как работает?

```rust
let text = String::from("Привет!");
```

```
СТЕК                     КУЧА
┌────────────┐          ┌──────────┐
│ text:      │          │          │
│ адрес ─────┼─────────►│ Привет!  │
│ длина: 7   │          │          │
└────────────┘          └──────────┘
     ↑                       ↑
  указатель              сами данные
  (pointer)
```

На стеке — **указатель** (англ. **pointer**) — адрес данных в куче. В куче — сами данные.

---

## Плюсы

| Плюс | Почему |
|------|--------|
| Большая | Гигабайты |
| Гибкая | Размер меняется |

---

## Минусы

| Минус | Почему |
|-------|--------|
| Медленнее | Нужно искать место |
| Надо следить | Надо освобождать память |

---

## Что хранить в куче?

- Текст (`String`)
- Списки (`Vec`)
- Большие данные
- Данные, которые растут

---

[← Стек](03-stack.md) | [Оглавление](README.md) | [Владение →](05-ownership.md)
